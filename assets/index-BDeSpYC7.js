var L=Object.defineProperty;var j=(o,t,e)=>t in o?L(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var M=(o,t,e)=>j(o,typeof t!="symbol"?t+"":t,e);import{u as x}from"./useCustomRouter-CiU2rkZM.js";import{T as z,L as E}from"./index-Dm8pkpH6.js";import{_ as I,a as O,o as i,c as h,b as w,f as A,d as g,u as l,e as $,C as B,p as m,t as R,n as T,D as V,v as b,A as U,r as N,k as G,B as Y,w as H,G as Q,M as W}from"./index-BGi8GpGv.js";import{a as F}from"./index-CJtyaUy2.js";import{u as J,G as K}from"./index-DQhdp3Mo.js";import{P as X}from"./index-CBHngC_A.js";import{c as Z,D as ee}from"./metaHelper-B8_iLp7n.js";import{u as te,C as q,a as re}from"./Content-CKsiGma2.js";import"./useForm-D-1CqejB.js";const le={class:"title-button-group"},se={__name:"Title",setup(o){const{addQuery:t}=x();return(e,r)=>{const s=O("Button");return i(),h(l(z),{title:"이메일 관리"},{rightArea:w(()=>[A("div",le,[g(s,{outlined:"",width:87,size:"x-small",title:"이메일 등록",onClick:r[0]||(r[0]=a=>l(t)({view:"add"}))})])]),_:1})}}},oe=I(se,[["__scopeId","data-v-2c261a42"]]),ne={class:"toolbar-wrapper"},ae={class:"right-area"},ue={__name:"Toolbar",setup(o){return(t,e)=>(i(),$("div",ne,[e[0]||(e[0]=A("div",{class:"left-area"},null,-1)),A("div",ae,[g(l(X))])]))}},ie=I(ue,[["__scopeId","data-v-25f2b8da"]]),ce={__name:"Alert",props:{modelValue:{},modelModifiers:{},type:{},typeModifiers:{}},emits:["update:modelValue","update:type"],setup(o){const t=B(o,"modelValue"),e=B(o,"type"),r=m(()=>e.value==="refresh"?"새로고침을 진행하시겠습니까?":e.value==="refresh_complete"?"DID 새로고침 완료":e.value==="restart"?"재시작을 진행하시겠습니까?":e.value==="restart_complete"?"DID 재시작 완료":e.value==="update"?"업데이트를 진행하시겠습니까?":e.value==="update_complete"?"DID 업데이트 완료":e.value==="on"?"기기 사용을 ON 하시겠습니까?":e.value==="on_complete"?"기기 사용 ON 완료":e.value==="off"?"기기 사용을 OFF 하시겠습니까?":e.value==="off_complete"?"기기 사용 OFF 완료":e.value==="finish"?"기기를 종료하시겠습니까?":e.value==="finish_complete"?"기기 종료 완료":""),s=m(()=>e.value==="refresh"?`새로고침을 할 경우,
단시간 기기가 멈출 수 있습니다.`:e.value==="refresh_complete"?"DID 새로고침이 완료됐습니다.":e.value==="restart"?`재시작을 할 경우,
기기에 콘텐츠 노출이 멈추게 됩니다.`:e.value==="restart_complete"?`DID 재시작이 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:e.value==="update"?`업데이트를 진행할 경우,
단시간 기기가 멈출 수 있습니다.`:e.value==="update_complete"?`DID 업데이트가 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:e.value==="on"?`기기 사용을 ON 하게 되면,
기기가 활성화됩니다.`:e.value==="on_complete"?`DID 업데이트가 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:e.value==="off"?`기기 사용을 OFF 하게 되면,
기기 화면이 대기 상태로 전환되게 됩니다.`:e.value==="off_complete"?`DID 업데이트가 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:e.value==="finish"?`기기 사용을 OFF 하게 되면,
기기가 꺼지게 됩니다.`:e.value==="finish_complete"?`DID 업데이트가 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:""),a=m(()=>{var d;return!((d=e.value)!=null&&d.endsWith("_complete"))}),c=m(()=>{var d;return(d=e.value)==null?void 0:d.endsWith("_complete")});function C(){e.value=`${e.value}_complete`}return(d,p)=>{const D=O("Alert",!0);return i(),h(D,{modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=f=>t.value=f),title:r.value,message:s.value,showCancel:a.value,confirmClickClose:c.value,"onClick:confirm":C},null,8,["modelValue","title","message","showCancel","confirmClickClose"])}}},de={__name:"Status",props:{item:{type:Object,default:()=>({})},column:{type:Object,default:()=>({})}},setup(o){const t=o,e=m(()=>t.item[t.column.key]),r=m(()=>{var s;return((s=t.column.items.find(a=>a.value===t.item[t.column.key]))==null?void 0:s.title)||"-"});return(s,a)=>(i(),$("div",{class:T({"bu-body-13-link":e.value==="PENDING"})},R(r.value),3))}},me={idx:{column:{title:"NO",type:"text"}},subject:{column:{title:"제목",type:"text"},form:{row:1,required:!0,autoFocus:!0,component:"input",label:"제목",placeholder:"제목을 입력해 주세요.",errorMessages:{error:"",require:""}}},body:{form:{row:2,required:!0,component:"editor",label:"본문 내용",placeholder:"내용을 입력해 주세요.",errorMessages:{error:"",require:""}}},sentCount:{column:{title:"전송 건수",type:"text"}},status:{column:{title:"처리 상태",type:"text"},form:{row:4,disabled:!0,component:"input",label:"처리 상태",class:"w-318",placeholder:"처리 상태는 등록 이후 변경됩니다.",errorMessages:{error:"",require:""}},common:{items:[{title:"Not Yet",value:"PENDING"},{title:"Finish",value:"COMPLETED"},{title:"Cancel",value:"CANCELLED"}]}},scheduledAt:{column:{title:"전송일시",type:"date"},form:{row:3,required:!0,component:"datePicker",label:"전송일시",class:"w-318",placeholder:"전송일시를 선택해 주세요.",errorMessages:{error:"",require:""}}},landingUrl:{form:{row:3,component:"input",label:"랜딩 페이지 URL 또는 화면 ID",class:"w-318",placeholder:"랜딩 페이지 URL 또는 화면 ID를 입력해 주세요.",errorMessages:{error:"",require:""}}},createdAt:{column:{title:"등록일",type:"date"}},detailView:{column:{title:"상세보기",type:"link"}}},pe=["idx","subject","sentCount","status","scheduledAt","createdAt","detailView"],fe=["subject","body","scheduledAt","landingUrl","status"],_e=Z(me,pe,fe);class k extends ee{constructor(t){super(t),this.detailView="상세보기"}toRequestBody(){return this.constructor.metaData.form.reduce((t,{key:e})=>["scheduledAt"].includes(e)?{...t,[e]:V(this[e]).valueOf()}:{...t,[e]:this[e]},{})}toPutRequestBody(){return this.constructor.metaData.form.reduce((t,{key:e})=>["scheduledAt"].includes(e)?{...t,[e]:V(this[e]).valueOf()}:{...t,[e]:this[e]},{})}}M(k,"metaData",_e);const ve={__name:"index",setup(o){const{page:t,size:e,totalPage:r,loading:s,items:a,addQuery:c}=J(d),C=k.toColumnHeaders();async function d(){var v;const f={page:t.value,size:e.value};s.value=!0,a.value.length=0;const _=await F("email").getPage(f),{result:u,body:n}=_||{};u.httpStatus===200&&(s.value=!1,(v=n==null?void 0:n.data)==null||v.forEach(y=>a.value.push(new k(y))),r.value=(n==null?void 0:n.totalPage)||0)}async function p({item:f,column:_,newValue:u}){if(a.value.findIndex(v=>v.id===f.id)!==-1){if(_.type==="link")return c({view:"detail",id:f.idx});_.type}}function D(){console.log("=== ")}return(f,_)=>(i(),h(l(K),{page:l(t),items:l(a),loading:l(s),totalPage:l(r),columnHeaders:l(C),"onClick:cell":p,"onClick:page":_[0]||(_[0]=u=>l(c)({page:u}))},{toolbar:w(()=>[g(ie)]),alert:w(()=>[g(ce)]),status:w(({item:u,column:n})=>[g(de,{item:u,column:n,onClick:D},null,8,["item","column"])]),_:1},8,["page","items","loading","totalPage","columnHeaders"]))}},he=I(ve,[["__scopeId","data-v-cb242040"]]),ge={__name:"index",setup(o){return(t,e)=>(i(),h(l(E),null,{title:w(()=>[g(oe)]),content:w(()=>[g(l(he))]),_:1}))}};function S(o){const t=k.toFormFields(),{values:e,errors:r,getFields:s,validateFields:a}=te(t);return{fields:s([],o),values:e,errors:r,validateFields:a}}const Ce={__name:"Create",setup(o){const{showAlert:t}=b("alert"),{routeList:e}=x(),{fields:r,values:s,errors:a,validateFields:c}=S(),C=b("methods");return C.cancel=()=>U(s)?t("cancel"):e(),C.submit=()=>{if(!c())return t("missing");t("regist",async()=>{var D;const d=new k({...s}),p=await F("email").create(d.toRequestBody());t(((D=p==null?void 0:p.result)==null?void 0:D.httpStatus)===200?"regist_complete":"missing")})},(d,p)=>(i(),h(q,{fields:l(r),values:l(s),errors:l(a)},null,8,["fields","values","errors"]))}},De={__name:"Detail",setup(o){const{showAlert:t}=b("alert"),e=b("footer-props"),{getQuery:r,routeList:s}=x(),{fields:a,values:c,errors:C,validateFields:d}=S(!0),p=m(()=>a.map(u=>u.map(n=>n.key!=="status"?{...n}:{...n,disabled:!1,component:"dropdown"}))),D=N(!1),f=N({});G(async()=>{var P;D.value=!0,e.disabledSubmit=!0;const u=await F("email").getDetail((P=r())==null?void 0:P.id),{result:n,body:v}=u||{};if(n.httpStatus!==200)return;const y=V(v.scheduledAt).format("YYYY-MM-DD");f.value=Y(c,{...v,scheduledAt:y}),D.value=!1}),H(c,()=>e.disabledSubmit=!Q(f.value,c));const _=b("methods");return _.cancel=()=>e.disabledSubmit?s():t("put_cancel"),_.delete=()=>t("delete",async()=>{var n,v;const u=await F("email").delete((n=r())==null?void 0:n.id);((v=u==null?void 0:u.result)==null?void 0:v.httpStatus)===200&&t("delete_complete")}),_.submit=()=>{if(!d())return t("missing");t("put",async()=>{var v,y;const u=new k({...c}),n=await F("email").update((v=r())==null?void 0:v.id,u.toPutRequestBody());((y=n==null?void 0:n.result)==null?void 0:y.httpStatus)===200&&t("put_complete")})},(u,n)=>(i(),h(q,{isDetail:"",fields:p.value,values:l(c),errors:l(C)},null,8,["fields","values","errors"]))}},we={class:"flex justify-between align-center"},be={class:"button-group"},ye={__name:"Footer",props:{isDetail:{type:Boolean,default:!1}},setup(o){const t=b("methods"),e=b("footer-props");return(r,s)=>{const a=O("Button");return i(),$("div",we,[s[0]||(s[0]=A("div",null,null,-1)),A("div",be,[g(a,{outlined:"",width:55,title:o.isDetail?"목록":"취소",size:"medium",color:"neutral",onClick:l(t).cancel},null,8,["title","onClick"]),o.isDetail?(i(),h(a,{key:0,size:"medium",title:"삭제",color:"red",width:55,onClick:l(t).delete},null,8,["onClick"])):W("",!0),g(a,{size:"medium",color:"primary",width:55,title:o.isDetail?"수정":"등록",disabled:l(e).disabledSubmit,onClick:l(t).submit},null,8,["title","disabled","onClick"])])])}}},ke=I(ye,[["__scopeId","data-v-5565ef66"]]),xe={__name:"Alert",setup(o){const{alertObj:t}=b("alert"),{routeList:e}=x(),r=m(()=>t.type),s=m(()=>r.value==="regist"?"이메일을 등록하시겠습니까?":r.value==="regist_complete"?"이메일 등록 완료":r.value==="cancel"?"이메일 등록을 취소하시겠습니까?":r.value==="missing"?"잘못된 정보 또는 누락된 정보가 있습니다.":r.value==="put"?"이메일을 수정하시겠습니까?":r.value==="put_complete"?"이메일 수정 완료":r.value==="put_cancel"?"이메일 수정을 취소하시겠습니까?":r.value==="delete"?"이메일을 삭제하시겠습니까?":r.value==="delete_complete"?"이메일 삭제 완료":""),a=m(()=>r.value==="regist_complete"?"이메일 등록이 완료됐습니다.":r.value==="cancel"?`이메일 등록을 취소할 경우,
입력한 정보가 삭제됩니다.`:r.value==="missing"?"입력한 정보를 다시 한번 확인해주세요.":r.value==="put"?"수정할 내용을 충분히 확인하셨나요?":r.value==="put_complete"?"이메일 전송 수정 완료했습니다.":r.value==="put_cancel"?`수정을 취소하면,
입력한 정보가 삭제됩니다.`:r.value==="delete"?`이메일을 삭제하면
사용자 화면에서 보이지 않습니다.`:r.value==="delete_complete"?"이메일 삭제 완료했습니다.":""),c=m(()=>r.value==="missing"),C=m(()=>["regist","cancel","delete","put","put_cancel"].includes(r.value)),d=m(()=>!["regist","put","delete"].includes(r.value)),p=m(()=>({cancel:e,regist:t["click:confirm"],regist_complete:e,delete:t["click:confirm"],delete_complete:e,put:t["click:confirm"],put_complete:e,put_cancel:e}));return(D,f)=>{const _=O("Alert",!0);return i(),h(_,{modelValue:l(t).show,"onUpdate:modelValue":f[0]||(f[0]=u=>l(t).show=u),title:s.value,error:c.value,message:a.value,showCancel:C.value,confirmClickClose:d.value,"onClick:confirm":p.value[r.value]},null,8,["modelValue","title","error","message","showCancel","confirmClickClose","onClick:confirm"])}}},Fe={__name:"index",setup(o){const{isDetail:t}=x();return(e,r)=>(i(),h(l(re),{title:l(t)?"이메일 등록 상세 내용":"이메일 등록"},{content:w(()=>[l(t)?(i(),h(De,{key:0})):(i(),h(Ce,{key:1}))]),footer:w(()=>[g(ke,{isDetail:l(t)},null,8,["isDetail"])]),alert:w(()=>[g(xe)]),_:1},8,["title"]))}},Se={__name:"index",setup(o){const{getQuery:t}=x();return(e,r)=>{var s;return["add","detail"].includes((s=l(t)())==null?void 0:s.view)?(i(),h(l(Fe),{key:0})):(i(),h(l(ge),{key:1}))}}};export{Se as default};
