var Q=Object.defineProperty;var K=(a,t,e)=>t in a?Q(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var S=(a,t,e)=>K(a,typeof t!="symbol"?t+"":t,e);import{u as F}from"./useCustomRouter-CiU2rkZM.js";import{T as W,L as Y}from"./index-Dm8pkpH6.js";import{o as c,c as w,u as i,_ as I,e as C,f as V,d as _,C as A,p as h,a as P,t as O,b as g,W as B,v as k,w as L,F as U,j as z,M as H,I as J,J as E,K as N,Q as X,r as G,k as Z,B as ee,G as te}from"./index-BGi8GpGv.js";import{a as T}from"./index-CJtyaUy2.js";import{u as re,G as ne}from"./index-DQhdp3Mo.js";import{P as oe}from"./index-CBHngC_A.js";import{c as ae,D as le}from"./metaHelper-B8_iLp7n.js";import{u as se,C as ie,a as ue}from"./Content-CKsiGma2.js";import j from"./TextView-qcU6xMhp.js";import"./useForm-D-1CqejB.js";const ce={__name:"Title",setup(a){return(t,e)=>(c(),w(i(W),{title:"대행사 관리"}))}},me={class:"toolbar-wrapper"},de={class:"right-area"},pe={__name:"Toolbar",setup(a){return(t,e)=>(c(),C("div",me,[e[0]||(e[0]=V("div",{class:"left-area"},null,-1)),V("div",de,[_(i(oe))])]))}},fe=I(pe,[["__scopeId","data-v-b7c40f74"]]),_e={__name:"Alert",props:{modelValue:{},modelModifiers:{},type:{},typeModifiers:{}},emits:["update:modelValue","update:type"],setup(a){const t=A(a,"modelValue"),e=A(a,"type"),r=h(()=>e.value==="refresh"?"새로고침을 진행하시겠습니까?":e.value==="refresh_complete"?"DID 새로고침 완료":e.value==="restart"?"재시작을 진행하시겠습니까?":e.value==="restart_complete"?"DID 재시작 완료":e.value==="update"?"업데이트를 진행하시겠습니까?":e.value==="update_complete"?"DID 업데이트 완료":e.value==="on"?"기기 사용을 ON 하시겠습니까?":e.value==="on_complete"?"기기 사용 ON 완료":e.value==="off"?"기기 사용을 OFF 하시겠습니까?":e.value==="off_complete"?"기기 사용 OFF 완료":e.value==="finish"?"기기를 종료하시겠습니까?":e.value==="finish_complete"?"기기 종료 완료":""),n=h(()=>e.value==="refresh"?`새로고침을 할 경우,
단시간 기기가 멈출 수 있습니다.`:e.value==="refresh_complete"?"DID 새로고침이 완료됐습니다.":e.value==="restart"?`재시작을 할 경우,
기기에 콘텐츠 노출이 멈추게 됩니다.`:e.value==="restart_complete"?`DID 재시작이 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:e.value==="update"?`업데이트를 진행할 경우,
단시간 기기가 멈출 수 있습니다.`:e.value==="update_complete"?`DID 업데이트가 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:e.value==="on"?`기기 사용을 ON 하게 되면,
기기가 활성화됩니다.`:e.value==="on_complete"?`DID 업데이트가 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:e.value==="off"?`기기 사용을 OFF 하게 되면,
기기 화면이 대기 상태로 전환되게 됩니다.`:e.value==="off_complete"?`DID 업데이트가 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:e.value==="finish"?`기기 사용을 OFF 하게 되면,
기기가 꺼지게 됩니다.`:e.value==="finish_complete"?`DID 업데이트가 완료됐습니다.
기기 상태를 주의깊게 확인해주세요.`:""),m=h(()=>{var y;return!((y=e.value)!=null&&y.endsWith("_complete"))}),u=h(()=>{var y;return(y=e.value)==null?void 0:y.endsWith("_complete")});function x(){e.value=`${e.value}_complete`}return(y,v)=>{const p=P("Alert",!0);return c(),w(p,{modelValue:t.value,"onUpdate:modelValue":v[0]||(v[0]=d=>t.value=d),title:r.value,message:n.value,showCancel:m.value,confirmClickClose:u.value,"onClick:confirm":x},null,8,["modelValue","title","message","showCancel","confirmClickClose"])}}},ve={__name:"Status",props:{item:{type:Object,default:()=>({})},column:{type:Object,default:()=>({})}},setup(a){const t=a,e=h(()=>{var r;return(r=t.column.items.find(n=>n.value===t.item[t.column.key]))==null?void 0:r.title});return(r,n)=>(c(),C("div",null,O(e.value),1))}},he={__name:"InquiryType",props:{item:{type:Object,default:()=>({})},column:{type:Object,default:()=>({})}},setup(a){const t=a,e=h(()=>{var r;return(r=t.column.items.find(n=>n.value===t.item[t.column.key]))==null?void 0:r.title});return(r,n)=>(c(),C("div",null,O(e.value),1))}},ye={__name:"InquiryChannel",props:{item:{type:Object,default:()=>({})},column:{type:Object,default:()=>({})}},setup(a){const t=a,e=h(()=>{var r;return(r=t.column.items.find(n=>n.value===t.item[t.column.key]))==null?void 0:r.title});return(r,n)=>(c(),C("div",null,O(e.value),1))}},ge={idx:{column:{title:"NO",type:"text"}},title:{column:{title:"제목",type:"text"},form:{row:1,label:"제목",component:"textView",disabled:!0,placeholder:"",errorMessages:{error:"",require:""}}},inquiryType:{column:{title:"문의 유형",type:"text"},form:{row:2,label:"문의 유형",disabled:!0,component:"custom",placeholder:"",errorMessages:{error:"",require:""}},common:{items:[{title:"결제",value:"PAYMENT"},{title:"이용방법",value:"USAGE"},{title:"취소/환불",value:"REFUND"},{title:"대행사/랩사 등록",value:"AGENCY_LAB_REGISTRATION"},{title:"서비스 문의",value:"SERVICE"},{title:"제휴 문의",value:"PARTNERSHIP"}]}},status:{column:{title:"처리 상태",type:"text"},common:{items:[{title:"Not Yet",value:"PENDING"},{title:"Add Ask",value:"PENDING_THREAD"},{title:"Finish",value:"COMPLETED"}]}},companyName:{column:{title:"회사",type:"text"},form:{row:3,label:"회사",disabled:!0,component:"input",placeholder:"",errorMessages:{error:"",require:""}}},inquirerName:{column:{title:"담당자",type:"text"},form:{row:3,label:"담당자",disabled:!0,component:"input",placeholder:"",errorMessages:{error:"",require:""}}},inquiryChannel:{column:{title:"문의 창구",type:"text"},form:{row:4,label:"문의 창구",disabled:!0,component:"input",placeholder:"",errorMessages:{error:"",require:""}},common:{items:[{title:"소개 화면",value:"INTRO_PAGE"},{title:"이용 화면",value:"SERVICE_PAGE"}]}},inquirerEmail:{column:{title:"이메일",type:"text"},form:{row:4,label:"이메일 (또는 계정 정보)",disabled:!0,component:"input",placeholder:"",errorMessages:{error:"",require:""}}},inquirerPhone:{column:{title:"연락처",type:"text"},form:{row:5,label:"연락처",disabled:!0,component:"input",placeholder:"",errorMessages:{error:"",require:""}}},threads:{form:{row:6,label:"문의 내용",disabled:!0,component:"custom",customName:"threads",placeholder:"",errorMessages:{error:"",require:""}}},addAnswer:{form:{row:7,label:"답변하기",required:!0,hideToolbar:!0,component:"editor",placeholder:"답변 내용을 입력해 주세요.",errorMessages:{error:"",require:""}}},createdAt:{column:{title:"등록일",type:"date"}},detailView:{column:{title:"상세보기",type:"link"}}},be=["idx","title","inquiryType","status","companyName","inquirerName","inquiryChannel","inquirerEmail","inquirerPhone","createdAt","detailView"],we=["title","inquiryType","companyName","inquirerName","inquiryChannel","inquirerEmail","inquirerPhone","threads","addAnswer"],Ce=ae(ge,be,we);class $ extends le{constructor(t){super(t),this.detailView="상세보기"}toRequestBody(){return this.constructor.metaData.form.reduce((t,{key:e})=>({...t,[e]:this[e]}),{})}toPutRequestBody(){return this.constructor.metaData.form.reduce((t,{key:e})=>({...t,[e]:this[e]}),{})}}S($,"metaData",Ce);const xe={__name:"index",setup(a){const{page:t,size:e,totalPage:r,loading:n,items:m,addQuery:u}=re(y),x=$.toColumnHeaders();async function y({agencyName:p,b_status:d,s_status:l}){var q;const o={page:t.value,size:e.value};p&&(o.searchKeyword=p),d&&(o.businessType=d),l&&(o.status=l),n.value=!0,m.value.length=0;const f=await T("inquiry/admin").getPage(o),{result:s,body:b}=f||{};s.httpStatus===200&&(n.value=!1,(q=b==null?void 0:b.data)==null||q.forEach(D=>m.value.push(new $(D))),r.value=(b==null?void 0:b.totalPage)||0)}async function v({item:p,column:d,newValue:l}){var f;if(m.value.findIndex(s=>s.id===p.id)!==-1){if(d.type==="link")return u({view:"detail",id:p.idx});if(d.type==="dropdown"){const s=await T("company").partialUpdate(p.idx,{[d.key]:l});((f=s==null?void 0:s.result)==null?void 0:f.httpStatus)===200&&(p[d.key]=l)}}}return(p,d)=>(c(),w(i(ne),{page:i(t),items:i(m),loading:i(n),totalPage:i(r),columnHeaders:i(x),"onClick:cell":v,"onClick:page":d[0]||(d[0]=l=>i(u)({page:l}))},{toolbar:g(()=>[_(fe)]),alert:g(()=>[_(_e)]),inquiryType:g(({item:l,column:o})=>[_(he,{item:l,column:o},null,8,["item","column"])]),status:g(({item:l,column:o})=>[_(ve,{item:l,column:o},null,8,["item","column"])]),inquiryChannel:g(({item:l,column:o})=>[_(ye,{item:l,column:o},null,8,["item","column"])]),_:1},8,["page","items","loading","totalPage","columnHeaders"]))}},qe=I(xe,[["__scopeId","data-v-46bb7ad9"]]),De={__name:"index",setup(a){return(t,e)=>(c(),w(i(Y),null,{title:g(()=>[_(ce)]),content:g(()=>[_(i(qe))]),_:1}))}};function ke(a){const t=$.toFormFields(),{values:e,errors:r,getRef:n,getFields:m}=se(t),u=m([],a);function x(y){var p;let v;for(const{required:d,key:l,group:o,errorMessages:f}of t){const s=o?e[o]:e,b=o?r[o]:r;(y||[]).includes(l)||(b[l]&&!v&&(v=l),!(l==="paymentDay"&&s.paymentMethod==="PREPAID")&&d&&B(s[l])&&(v||(v=l),b[l]=(f==null?void 0:f.require)||" "))}return(p=n(v))==null||p.focus(),!v}return{fields:u,values:e,errors:r,validateFields:x}}const Ie={class:"flex flex-col flex-grow-1"},Pe={__name:"Threads",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(a){const t=A(a,"modelValue"),e=k("footer-props");return L(t,r=>{const{answer:n}=r.at(-1)||{};e.disabledSubmit=!n,e.hideSubmit=!!n},{immediate:!0}),(r,n)=>(c(),C("div",Ie,[(c(!0),C(U,null,z(t.value,(m,u)=>(c(),C("div",{key:u,class:"threads-wrapper"},[_(j,{label:`${u>0?"추가":""} 문의 내용`,"model-value":m.question},null,8,["label","model-value"]),m.answer?(c(),w(j,{key:0,label:"답변 내용",class:"answer","model-value":m.answer},null,8,["model-value"])):H("",!0)]))),128))]))}},Ve=I(Pe,[["__scopeId","data-v-0b7e579e"]]),Ae={class:"inquiry-type-wrapper"},Te={__name:"InquiryType",props:J({items:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const t=A(a,"modelValue");return(e,r)=>{const n=P("Radio"),m=P("RadioGroup");return c(),C("div",Ae,[_(i(X),E(N(e.$attrs)),null,16),_(m,{modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=u=>t.value=u)},{default:g(()=>[(c(!0),C(U,null,z(a.items,u=>(c(),w(n,{key:u.value,disabled:"",label:u.title,value:u.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])}}},$e=I(Te,[["__scopeId","data-v-3bb97a5e"]]),Ee={__name:"Detail",setup(a){const{showAlert:t}=k("alert"),e=k("footer-props"),{getQuery:r,routeList:n}=F(),{fields:m,values:u,errors:x,validateFields:y}=ke(!0),v=h(()=>m.filter(o=>o.find(f=>{var s;return f.key==="addAnswer"?!((s=u.threads.at(-1))!=null&&s.answer):!0})).map(o=>o.map(f=>({...f})))),p=G(!1),d=G({});Z(async()=>{var D;p.value=!0;const o=await T("inquiry/admin").getDetail((D=r())==null?void 0:D.id),{result:f,body:s}=o||{};if(f.httpStatus!==200)return;const q=[{question:s.question,answer:s.answer},...(s==null?void 0:s.threads)||[]];d.value=ee(u,{...s,threads:q}),p.value=!1}),L(()=>u.addAnswer,o=>e.disabledSubmit=B(o));const l=k("methods");return l.cancel=()=>te(d.value,u)?t("cancel"):n(),l.submit=()=>{if(!y())return t("missing");t("regist",async()=>{var D,M,R;const{threads:o,addAnswer:f}=u,{idx:s}=o.at(-1),b=(o==null?void 0:o.length)>1?`inquiry/${(D=r())==null?void 0:D.id}/thread/${s}/reply`:`inquiry/${(M=r())==null?void 0:M.id}/reply`,q=await T(b).create({answer:f});((R=q==null?void 0:q.result)==null?void 0:R.httpStatus)===200&&t("regist_complete")})},(o,f)=>(c(),w(ie,{isDetail:"",fields:v.value,values:i(u),errors:i(x)},{custom:g(s=>[_($e,E(N(s)),null,16)]),threads:g(s=>[_(Ve,E(N(s)),null,16)]),_:1},8,["fields","values","errors"]))}},Ne=I(Ee,[["__scopeId","data-v-2591d2bd"]]),Fe={class:"flex justify-between align-center"},Oe={class:"button-group"},Me={__name:"Footer",setup(a){const t=k("methods"),e=k("footer-props");return(r,n)=>{const m=P("Button");return c(),C("div",Fe,[n[0]||(n[0]=V("div",null,null,-1)),V("div",Oe,[_(m,{outlined:"",size:"medium",color:"neutral",width:55,title:i(e).hideSubmit?"목록":"취소",onClick:i(t).cancel},null,8,["title","onClick"]),i(e).hideSubmit?H("",!0):(c(),w(m,{key:0,title:"등록",size:"medium",color:"primary",width:55,disabled:i(e).disabledSubmit,onClick:i(t).submit},null,8,["disabled","onClick"]))])])}}},Re=I(Me,[["__scopeId","data-v-de4e76ef"]]),Se={__name:"Alert",setup(a){const{alertObj:t}=k("alert"),{routeList:e}=F(),r=h(()=>t.type),n=h(()=>r.value==="missing"?"잘못된 정보 또는 누락된 정보가 있습니다.":r.value==="cancel"?"문의사항 답변 등록을 취소 하시겠습니까?":r.value==="regist"?"문의사항 답변을 등록하시겠습니까?":r.value==="regist_complete"?"문의사항 답변 등록 완료.":""),m=h(()=>r.value==="missing"?"입력한 정보를 다시 한번 확인해주세요.":r.value==="cancel"?`문의사항 답변 등록을 취소할 경우,
입력한 정보가 삭제됩니다.`:r.value==="regist"?"한번 답변을 등록하면 수정이 불가능합니다.":r.value==="regist_complete"?"문의사항 답변이 등록 완료됐습니다.":""),u=h(()=>r.value==="missing"),x=h(()=>["cancel","regist"].includes(r.value)),y=h(()=>r.value!=="regist"),v=h(()=>({cancel:e,regist_complete:e,regist:t["click:confirm"]}));return(p,d)=>{const l=P("Alert",!0);return c(),w(l,{modelValue:i(t).show,"onUpdate:modelValue":d[0]||(d[0]=o=>i(t).show=o),error:u.value,title:n.value,message:m.value,showCancel:x.value,confirmClickClose:y.value,"onClick:confirm":v.value[r.value]},null,8,["modelValue","error","title","message","showCancel","confirmClickClose","onClick:confirm"])}}},Ge={__name:"index",setup(a){return(t,e)=>(c(),w(i(ue),{title:"문의사항 상세 내용"},{content:g(()=>[_(Ne)]),footer:g(()=>[_(Re)]),alert:g(()=>[_(Se)]),_:1}))}},Xe={__name:"index",setup(a){const{getQuery:t}=F();return(e,r)=>{var n;return["detail"].includes((n=i(t)())==null?void 0:n.view)?(c(),w(i(Ge),{key:0})):(c(),w(i(De),{key:1}))}}};export{Xe as default};
